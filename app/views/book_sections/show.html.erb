<% breadcrumb :books %>
<% breadcrumb :book, @book %>
<% breadcrumb :book_section, @book, @section %>
<%= render "shared/breadcrumbs" %>

<div class="mx-auto w-full max-w-3xl px-4 md:px-6 lg:px-8">
  <nav class="mb-6 text-sm">
    <%= link_to "← #{@book.title} に戻る", book_path(@book), class: "text-slate-600 hover:underline" %>
  </nav>

  <% if can_edit?(@section) %>
    <div class="mb-4">
      <%= link_to "編集", edit_book_section_path(@book, @section),
            class: "inline-block px-3 py-1 rounded bg-slate-900 text-white text-sm" %>
    </div>
  <% end %>

  <h1 class="text-2xl font-bold mb-3">
    <span class="text-slate-400 mr-2"><%= @section.position %>.</span>
    <%= @section.heading %>
  </h1>

  <article class="content-body prose break-all md:break-words">
    <%= render_section_content(@section) %>
  </article>

  <div class="flex items-center justify-between mt-10 pt-6 border-t">
    <div>
      <% if @prev %>
        <%= link_to "◀ 前へ：#{@prev.heading}",
            book_section_path(@book, @prev),
            class: "text-slate-700 hover:underline" %>
      <% end %>
    </div>
    <div>
      <% if @next %>
        <%= link_to "次へ ▶：#{@next.heading}",
            book_section_path(@book, @next),
            class: "text-slate-700 hover:underline" %>
      <% end %>
    </div>
  </div>

  <% if can_edit?(@section) %>
    <div class="mb-4">
      <%= link_to "編集", edit_book_section_path(@book, @section),
            class: "inline-block px-3 py-1 rounded bg-slate-900 text-white text-sm" %>
    </div>
  <% end %>
</div>
