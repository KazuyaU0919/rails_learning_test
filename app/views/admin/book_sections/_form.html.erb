<%= form_with model: @section,
              url: (@section.new_record? ? admin_book_sections_path : admin_book_section_path(@section)),
              method: (@section.new_record? ? :post : :patch),
              data: { controller: "quill" } do |f| %>

  <div class="grid gap-8 text-[17px]">  <!-- 全体を少し大きめに -->

    <!-- 教本（セレクト） -->
    <div class="space-y-2">
      <%= f.label :book_id, class: "block font-semibold text-slate-800" %>
      <%= f.collection_select :book_id, Book.order(:title), :id, :title, {},
            class: "w-full md:w-[28rem] rounded-md border border-slate-300 bg-white px-3 py-2
                    shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500" %>
    </div>

    <!-- Position / Is free / Heading（見出しは横並びで値を入力） -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="space-y-2">
        <%= f.label :position, class: "block font-semibold text-slate-800" %>
        <%= f.number_field :position, min: 0,
              class: "w-40 rounded-md border border-slate-300 bg-white px-3 py-2
                      shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500" %>
      </div>

      <div class="flex items-center gap-3 pt-7 md:pt-0">
        <%= f.check_box :is_free, class: "h-5 w-5 align-middle rounded border-slate-300
                                        text-sky-600 focus:ring-sky-500" %>
        <%= f.label :is_free, class: "font-semibold text-slate-800" %>
      </div>

      <!-- Heading：入力を横並びに -->
      <div class="flex items-center gap-3">
        <%= f.label :heading, class: "shrink-0 font-semibold text-slate-800" %>
        <%= f.text_field :heading,
              class: "flex-1 rounded-md border border-slate-300 bg-white px-3 py-2
                      shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500" %>
      </div>
    </div>

    <!-- 本文（Quill 編集用） -->
    <div class="space-y-2">
      <%= f.label :content, class: "block font-semibold text-slate-800" %>
      <div id="quill-editor" class="bg-white rounded min-h-[18rem] mb-6 ql-container ql-snow"></div>
      <%= f.hidden_field :content, id: "content_field", autocomplete: "off" %>
    </div>

    <!-- 画像 -->
    <div class="mt-20 space-y-2">
      <%= f.label :images, class: "block font-semibold text-slate-800" %>
      <%= f.file_field :images, multiple: true, direct_upload: true,
            class: "block w-full max-w-md text-sm text-slate-600
                    file:mr-4 file:px-4 file:py-2
                    file:rounded-lg file:border file:border-slate-300
                    file:bg-white file:font-medium
                    file:text-slate-700 hover:file:bg-slate-50" %>

      <% if @section.images.attached? %>
        <ul class="mt-3 grid grid-cols-2 sm:grid-cols-3 gap-3">
          <% @section.images.each do |img| %>
            <li><%= image_tag img.variant(resize_to_limit: [400, 400]).processed, class: "rounded" %></li>
          <% end %>
        </ul>
      <% end %>
    </div>

    <!-- 送信ボタン -->
    <div class="pt-2">
      <%= f.submit(@section.new_record? ? "作成する" : "更新する",
            class: "inline-flex items-center rounded-lg bg-slate-900 px-5 py-2.5
                    text-white hover:bg-slate-800 disabled:opacity-50") %>
    </div>
  </div>
<% end %>
