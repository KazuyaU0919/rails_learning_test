<% breadcrumb :quizzes %>
<% breadcrumb :quiz, @quiz %>
<% breadcrumb :quiz_section_public, @quiz, @section %>
<% breadcrumb :quiz_question, @quiz, @section, @question %>
<%= render "shared/breadcrumbs" %>

<% content_for :title, "#{@section.heading} - 問題" %>
<p class="text-sm text-slate-500 mb-2">
  <%= link_to @quiz.title, quiz_path(@quiz) %> / <%= @section.heading %>
</p>

<div class="rounded border p-4 bg-white" data-controller="code-highlight">
  <p class="text-slate-500 text-sm mb-1">Q<%= @question.position %></p>

  <!-- 問題文（リッチ表示） -->
  <h2 class="text-lg font-semibold mb-3 content-body">
    <%= rich_html(@question.question) %>
  </h2>

  <%= form_with url: answer_quiz_section_question_path(@quiz, @section, @question),
                method: :post,
                data: { turbo: false },
                authenticity_token: true,
                local: true,
                class: "space-y-2" do %>

    <% (1..4).each do |i| %>
      <% label = @question.public_send("choice#{i}") %>
      <label class="block">
        <%= radio_button_tag :choice, i, false, required: true %>
        <span class="ml-2"><%= label %></span>
      </label>
    <% end %>

    <div class="mt-3">
      <%= submit_tag "この回答で送信", class: "px-4 py-2 rounded bg-[#CC0000] text-white" %>
    </div>
  <% end %>
</div>

<% if can_edit?(@question) %>
  <div class="mb-3">
    <%= link_to "この問題を編集", edit_quiz_section_question_path(@quiz, @section, @question),
          class: "inline-block px-3 py-1 rounded bg-slate-900 text-white text-sm" %>
  </div>
<% end %>
