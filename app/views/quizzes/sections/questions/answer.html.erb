<% breadcrumb :quizzes %>
<% breadcrumb :quiz, @quiz %>
<% breadcrumb :quiz_section_public, @quiz, @section %>
<% breadcrumb :quiz_question_answer_page, @quiz, @section, @question %>
<%= render "shared/breadcrumbs" %>

<% correct = (params[:choice].to_i == @question.correct_choice) %>
<div class="rounded border p-4 bg-white" data-controller="code-highlight">
  <p class="<%= correct ? 'text-emerald-700' : 'text-red-700' %> font-semibold">
    <%= correct ? "正解！" : "不正解…" %>
  </p>
  <p class="mt-1 text-sm">正解：<%= @question.public_send("choice#{@question.correct_choice}") %></p>

  <div class="mt-3 p-3 rounded bg-slate-50 content-body">
    <h3 class="font-semibold mb-1">解説</h3>
    <div><%= rich_html(@question.explanation) %></div>
  </div>

  <div class="flex justify-between mt-4">
    <% if @next_q %>
      <%= link_to "次の問題へ →", quiz_section_question_path(@quiz, @section, @next_q), class: "underline" %>
    <% else %>
      <%= link_to "結果を見る", result_quiz_section_path(@quiz, @section), class: "underline" %>
    <% end %>
  </div>
</div>

<% if can_edit?(@question) %>
  <div class="mb-3">
    <%= link_to "この問題を編集", edit_quiz_section_question_path(@quiz, @section, @question),
          class: "inline-block px-3 py-1 rounded bg-slate-900 text-white text-sm" %>
  </div>
<% end %>
