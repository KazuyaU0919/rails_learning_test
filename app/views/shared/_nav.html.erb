<!-- app/views/shared/_nav.html.erb -->
<header class="border-b bg-white">
  <!-- ここをコントローラの“親”にする（トリガーとモーダルを同じスコープに） -->
  <div class="mx-auto max-w-3xl px-4 py-3 flex items-center justify-between"
       data-controller="modal">

    <%= link_to "RailsLearningTest", root_path, class: "font-semibold" %>

    <!-- この位置でモーダルを描画（同じ controller スコープ内） -->
    <%= render "shared/modal_panel" %>

    <!-- グローバルナビ（従来のリンク） -->
    <nav class="flex items-center gap-3 text-sm px-4 py-2">
      <%# だれでも表示 %>
      <%= link_to "Code Editor", editor_path,
          class: "px-3 py-1 rounded-lg ring-1 ring-slate-300 hover:bg-slate-50" %>
      <%= link_to "Rails Books", books_path,
          class: "px-3 py-1 rounded-lg ring-1 ring-slate-300 hover:bg-slate-50" %>
      <%= link_to "PreCode", pre_codes_path,
          class: "px-3 py-1 rounded-lg ring-1 ring-slate-300 hover:bg-slate-50" %>
      <%= link_to "Code Library", code_libraries_path,
          class: "px-3 py-1 rounded-lg ring-1 ring-slate-300 hover:bg-slate-50" %>

      <%# ログイン時は 追加アクション無し（ログアウト/管理はモーダルへ集約） %>
      <% if logged_in? %>
      <% else %>
        <%# 未ログイン時は ヘッダでは「ログイン」のみ表示（新規登録はモーダルへ） %>
        <%= link_to "ログイン", new_session_path,
            class: "px-3 py-1 rounded-lg ring-1 ring-slate-300 hover:bg-slate-50" %>
      <% end %>
    </nav>

    <!-- ハンバーガーボタン -->
    <button
      class="p-2 rounded-lg hover:bg-slate-100"
      data-action="click->modal#open"
      aria-label="メニューを開く">
      ≡
    </button>
  </div>
</header>
